---
phase: 09-section-experiences
plan: 03
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - src/pages/Gallery.tsx
  - public/images/gallery-poster.jpg
autonomous: true

must_haves:
  truths:
    - "Gallery feels light, airy, and spacious"
    - "Images reveal with graceful stagger animation"
    - "Lightbox transitions are smooth and polished"
    - "Video background degrades to poster on mobile"
  artifacts:
    - path: "src/pages/Gallery.tsx"
      provides: "Enhanced Gallery page with light, airy personality"
      contains: "galleryVariants"
    - path: "public/images/gallery-poster.jpg"
      provides: "Poster fallback for VideoBackground"
  key_links:
    - from: "src/pages/Gallery.tsx"
      to: "@/components/effects/VideoBackground"
      via: "component import"
      pattern: "import.*VideoBackground.*from"
    - from: "src/pages/Gallery.tsx"
      to: "@/lib/motion"
      via: "galleryVariants import"
      pattern: "import.*galleryVariants.*from"
---

<objective>
Transform Gallery page into a light, spacious experience with graceful image reveals and polished lightbox transitions.

Purpose: Gallery should feel like a curated exhibition space - clean, unhurried, letting the images speak.
Output: Enhanced Gallery.tsx using VideoBackground, galleryVariants, Grid primitive, and staggered image reveals.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-section-experiences/09-RESEARCH.md
@src/pages/Gallery.tsx
@src/components/effects/VideoBackground.tsx
@src/components/layout/Container.tsx
@src/components/layout/Grid.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract poster frame from gallery video</name>
  <files>public/images/gallery-poster.jpg</files>
  <action>
Extract a poster frame from the gallery video for mobile/low-power fallback.

Option A (if ffmpeg available):
```bash
ffmpeg -i src/videos/logo_canvas.webm -vframes 1 -q:v 2 public/images/gallery-poster.jpg
```

Option B (fallback):
Create or use an existing light/branded image. Gallery's section tokens use a lighter palette (neutral-100 bg), so poster should complement this.

Requirements:
- At least 1920x1080
- Compressed to ~100-200KB
- Matches video aesthetic
  </action>
  <verify>File exists at public/images/gallery-poster.jpg</verify>
  <done>Poster image ready for Gallery VideoBackground</done>
</task>

<task type="auto">
  <name>Task 2: Enhance Gallery.tsx with VideoBackground, galleryVariants, and stagger animations</name>
  <files>src/pages/Gallery.tsx</files>
  <action>
Refactor Gallery.tsx:

1. **Replace inline video** with VideoBackground:
```tsx
import { VideoBackground } from '@/components/effects';

<VideoBackground
  src={logoCanvasVideo}
  poster="/images/gallery-poster.jpg"
  overlayOpacity={0.1}  // Light overlay for gallery's airy feel
/>
```
Remove inline `<video>` and `isWebMSupported()` check.

2. **Use galleryVariants for page transition**:
```tsx
import { motion, galleryVariants, galleryStaggerContainer, staggerItem, overlayVariants, modalVariants } from '@/lib/motion';

<motion.div
  className={styles['gallery-container']}
  data-section="gallery"
  variants={galleryVariants}
  initial="initial"
  animate="enter"
  exit="exit"
>
```

3. **Add KineticText for headline** (optional but recommended):
```tsx
import { KineticText } from '@/components/KineticText';

<RevealOnScroll>
  <KineticText as="h1" splitBy="words" variant="default">
    Gallery
  </KineticText>
</RevealOnScroll>
```
Using "words" split for a gentler feel matching gallery's personality.

4. **Use Container and Stack for layout**:
```tsx
import { Container } from '@/components/layout/Container';
import { Stack } from '@/components/layout/Stack';

<Container size="lg" padding="md">
  <Stack gap="xl">
    {/* content */}
  </Stack>
</Container>
```

5. **Replace individual RevealOnScroll with stagger container**:
```tsx
<motion.div
  variants={galleryStaggerContainer}
  initial="initial"
  animate="enter"
  className="grid grid-cols-1 md:grid-cols-2 gap-6"
>
  {images.map((image, index) => (
    <motion.div key={index} variants={staggerItem}>
      <img
        loading="lazy"
        src={image.src}
        alt={image.caption}
        className="w-full rounded-lg cursor-pointer hover:opacity-90 transition-opacity"
        onClick={() => openOverlay(index)}
        onLoad={index === 0 ? handleContentLoad : undefined}
      />
      <Caption>{image.caption}</Caption>
    </motion.div>
  ))}
</motion.div>
```
Remove individual RevealOnScroll wrappers from images.

6. **Enhance lightbox transition** using modalVariants:
```tsx
<AnimatePresence>
  {overlayImage && (
    <motion.div
      className={styles['overlay']}
      onClick={closeOverlay}
      variants={overlayVariants}
      initial="initial"
      animate="enter"
      exit="exit"
      data-lenis-prevent
    >
      <motion.div
        variants={modalVariants}
        initial="initial"
        animate="enter"
        exit="exit"
        className="relative"
        onClick={(e) => e.stopPropagation()}
      >
        {/* lightbox content */}
      </motion.div>
    </motion.div>
  )}
</AnimatePresence>
```

7. **Keep existing functionality**:
- Loading state
- Keyboard navigation (arrows, escape)
- Image click to open overlay
- Navigate left/right in overlay
  </action>
  <verify>
1. `npm run ts:check:types` passes
2. `npm run build` succeeds
3. Manual verification: Gallery images stagger in, lightbox transitions smoothly
  </verify>
  <done>
- VideoBackground replaces inline video
- galleryVariants used for page transition
- Images stagger in gracefully
- Lightbox uses modalVariants for polished enter/exit
- Container/Stack provide layout
  </done>
</task>

</tasks>

<verification>
- [ ] Gallery uses VideoBackground (not inline video)
- [ ] Poster exists and is used as fallback
- [ ] galleryVariants applied for gentle page transition
- [ ] Images stagger in with galleryStaggerContainer
- [ ] Lightbox overlay uses overlayVariants/modalVariants
- [ ] Keyboard navigation still works
- [ ] TypeScript compiles
- [ ] Build succeeds
</verification>

<success_criteria>
Gallery feels distinctly different from Home - lighter, airier, more spacious. Images cascade in gracefully rather than appearing as a block. The lightbox feels polished with proper enter/exit choreography. Mobile users get a clean poster fallback.
</success_criteria>

<output>
After completion, create `.planning/phases/09-section-experiences/09-03-SUMMARY.md`
</output>
