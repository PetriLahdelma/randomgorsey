---
phase: 06-layout-primitives
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/layout/Stack.tsx
  - src/components/layout/Cluster.tsx
  - src/components/layout/index.ts
autonomous: true

must_haves:
  truths:
    - "Developer can import Stack from @/components/layout"
    - "Developer can import Cluster from @/components/layout"
    - "Stack arranges children vertically with consistent gap spacing"
    - "Cluster arranges children horizontally with wrapping"
  artifacts:
    - path: "src/components/layout/Stack.tsx"
      provides: "Vertical spacing component with CVA variants"
      exports: ["Stack", "stackVariants"]
    - path: "src/components/layout/Cluster.tsx"
      provides: "Horizontal wrapping component with CVA variants"
      exports: ["Cluster", "clusterVariants"]
    - path: "src/components/layout/index.ts"
      provides: "Barrel export for layout primitives"
      exports: ["Stack", "Cluster"]
  key_links:
    - from: "src/components/layout/Stack.tsx"
      to: "@/lib/utils"
      via: "cn import"
      pattern: "import.*cn.*from.*@/lib/utils"
    - from: "src/components/layout/Cluster.tsx"
      to: "@/lib/utils"
      via: "cn import"
      pattern: "import.*cn.*from.*@/lib/utils"
---

<objective>
Create Stack and Cluster layout primitives following the Every Layout philosophy with Tailwind CSS and CVA.

Purpose: These foundational components enable composable vertical (Stack) and horizontal (Cluster) layouts without margin hacks. They follow the established project pattern of using CVA for variant management.

Output: Two new components in src/components/layout/ with barrel export
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-layout-primitives/06-RESEARCH.md

Reference patterns:
@src/components/Surface.tsx (CVA pattern, polymorphic as prop)
@src/components/Button.tsx (CVA pattern, forwardRef)
@src/lib/utils.ts (cn utility)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Stack component</name>
  <files>src/components/layout/Stack.tsx</files>
  <action>
Create Stack.tsx following the Surface.tsx pattern:

1. Import cva, VariantProps from class-variance-authority
2. Import cn from @/lib/utils

3. Define stackVariants with CVA:
   - Base: "flex flex-col"
   - gap variants: none (gap-0), xs (gap-1), sm (gap-2), md (gap-4), lg (gap-6), xl (gap-8), 2xl (gap-12), section (gap-16)
   - align variants: start (items-start), center (items-center), end (items-end), stretch (items-stretch)
   - defaultVariants: gap: "md", align: "stretch"

4. Define StackProps interface:
   - children: React.ReactNode
   - gap?: variant type
   - align?: variant type
   - as?: React.ElementType (default "div")
   - className?: string

5. Create Stack component with polymorphic `as` prop pattern (match Surface.tsx style)

6. Export Stack as default and named, export stackVariants
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit src/components/layout/Stack.tsx</verify>
  <done>Stack component exists with gap and align variants, polymorphic as prop</done>
</task>

<task type="auto">
  <name>Task 2: Create Cluster component</name>
  <files>src/components/layout/Cluster.tsx</files>
  <action>
Create Cluster.tsx following the same CVA pattern:

1. Import cva, VariantProps from class-variance-authority
2. Import cn from @/lib/utils

3. Define clusterVariants with CVA:
   - Base: "flex flex-wrap"
   - gap variants: none (gap-0), xs (gap-1), sm (gap-2), md (gap-4), lg (gap-6)
   - justify variants: start (justify-start), center (justify-center), end (justify-end), between (justify-between)
   - align variants: start (items-start), center (items-center), end (items-end), baseline (items-baseline), stretch (items-stretch)
   - defaultVariants: gap: "md", justify: "start", align: "center"

4. Define ClusterProps interface:
   - children: React.ReactNode
   - gap?: variant type
   - justify?: variant type
   - align?: variant type
   - as?: React.ElementType (default "div")
   - className?: string

5. Create Cluster component with polymorphic `as` prop pattern

6. Export Cluster as default and named, export clusterVariants
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit src/components/layout/Cluster.tsx</verify>
  <done>Cluster component exists with gap, justify, and align variants</done>
</task>

<task type="auto">
  <name>Task 3: Create barrel export</name>
  <files>src/components/layout/index.ts</files>
  <action>
Create index.ts barrel export:

```typescript
export { Stack, stackVariants } from "./Stack";
export { Cluster, clusterVariants } from "./Cluster";
```

Also export types if needed for external consumption.
  </action>
  <verify>
Import test in Node REPL or verify build passes:
npm run build
  </verify>
  <done>Layout primitives importable from @/components/layout</done>
</task>

</tasks>

<verification>
1. npm run build passes without errors
2. Both components are importable from src/components/layout
3. TypeScript types are correct for all variant props
</verification>

<success_criteria>
- Stack component renders children vertically with gap-based spacing
- Cluster component renders children horizontally with wrapping
- Both components support polymorphic `as` prop
- Both components follow existing CVA patterns from project
- Build passes with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-layout-primitives/06-01-SUMMARY.md`
</output>
