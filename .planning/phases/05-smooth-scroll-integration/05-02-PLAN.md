---
phase: 05-smooth-scroll-integration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/motion/variants.ts
  - src/lib/motion/index.ts
  - src/components/RevealOnScroll.tsx
autonomous: true

must_haves:
  truths:
    - "Developer can import reveal variants from @/lib/motion"
    - "Developer can wrap content in RevealOnScroll for scroll-triggered animations"
    - "User sees content animate in as they scroll down the page"
  artifacts:
    - path: "src/lib/motion/variants.ts"
      provides: "Scroll-triggered reveal variants"
      contains: "revealVariants"
    - path: "src/components/RevealOnScroll.tsx"
      provides: "Reusable reveal wrapper component"
      min_lines: 30
  key_links:
    - from: "src/components/RevealOnScroll.tsx"
      to: "src/lib/motion/variants.ts"
      via: "import revealVariants"
      pattern: "revealVariants"
    - from: "src/components/RevealOnScroll.tsx"
      to: "framer-motion"
      via: "whileInView prop"
      pattern: "whileInView"
---

<objective>
Create reveal animation variants and reusable RevealOnScroll component

Purpose: Provide consistent scroll-driven reveal animations across the site
Output: Reveal variants in motion config and RevealOnScroll component for easy application
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-smooth-scroll-integration/05-RESEARCH.md
@src/lib/motion/variants.ts
@src/lib/motion/config.ts
@src/lib/motion/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add reveal variants to variants.ts</name>
  <files>src/lib/motion/variants.ts</files>
  <action>
Add four new variant sets to variants.ts for scroll-triggered reveals:

1. `revealVariants` - Standard reveal with opacity + y transform
2. `revealContainerVariants` - Parent for staggered reveals
3. `revealItemVariants` - Child items for staggered reveals
4. `revealFadeVariants` - Reduced-motion safe (opacity only)

These variants use `hidden`/`visible` naming (not initial/enter) because they work with whileInView which expects hidden/visible.

Add to variants.ts:

```typescript
// === SCROLL-TRIGGERED REVEALS ===

/**
 * Standard scroll-triggered reveal animation.
 * Use with whileInView="visible" viewport={{ once: true, amount: 0.3 }}
 *
 * Uses hidden/visible naming for whileInView compatibility.
 */
export const revealVariants: Variants = {
  hidden: { opacity: 0, y: 30 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: durations.normal,
      ease: eases.out,
    },
  },
};

/**
 * Container variant for staggered scroll reveals.
 * Apply to parent element containing revealItemVariants children.
 *
 * @example
 * ```tsx
 * <motion.ul
 *   variants={revealContainerVariants}
 *   initial="hidden"
 *   whileInView="visible"
 *   viewport={{ once: true }}
 * >
 *   {items.map(item => (
 *     <motion.li key={item.id} variants={revealItemVariants}>
 *       {item.content}
 *     </motion.li>
 *   ))}
 * </motion.ul>
 * ```
 */
export const revealContainerVariants: Variants = {
  hidden: {},
  visible: {
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.1,
    },
  },
};

/**
 * Item variant for children in staggered scroll reveals.
 * Must be used with revealContainerVariants parent.
 */
export const revealItemVariants: Variants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: durations.normal,
      ease: eases.out,
    },
  },
};

/**
 * Reduced motion safe reveal (opacity only).
 * Use for users with prefers-reduced-motion.
 * No transform animations - just fade.
 */
export const revealFadeVariants: Variants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: { duration: durations.normal },
  },
};
```
  </action>
  <verify>`npm run ts:check:types` passes</verify>
  <done>Four reveal variant sets added to variants.ts with JSDoc documentation</done>
</task>

<task type="auto">
  <name>Task 2: Create RevealOnScroll component</name>
  <files>src/components/RevealOnScroll.tsx</files>
  <action>
Create a reusable RevealOnScroll wrapper component that:

1. Uses motion.div with whileInView
2. Automatically uses revealFadeVariants when reduced motion is enabled
3. Configurable viewport options (once, amount)
4. Accepts className and other div props
5. Supports 'as' prop for semantic elements (div, section, article)

```typescript
import React from 'react';
import { motion, useReducedMotion } from 'framer-motion';
import type { HTMLMotionProps } from 'framer-motion';
import { revealVariants, revealFadeVariants } from '@/lib/motion';

type ElementType = 'div' | 'section' | 'article' | 'aside' | 'main' | 'header' | 'footer';

interface RevealOnScrollProps extends Omit<HTMLMotionProps<'div'>, 'variants' | 'initial' | 'whileInView' | 'viewport'> {
  children: React.ReactNode;
  /** HTML element to render. Default: 'div' */
  as?: ElementType;
  /** Trigger animation only once. Default: true */
  once?: boolean;
  /** Amount of element that must be visible (0-1). Default: 0.3 */
  amount?: number;
  /** Margin around viewport for early/late trigger. Default: '0px' */
  margin?: string;
  /** Custom className */
  className?: string;
}

/**
 * Wrapper component for scroll-triggered reveal animations.
 * Automatically respects reduced-motion preferences.
 *
 * @example
 * ```tsx
 * <RevealOnScroll>
 *   <h2>This heading reveals on scroll</h2>
 * </RevealOnScroll>
 *
 * <RevealOnScroll as="section" amount={0.5}>
 *   <p>This section waits until 50% visible</p>
 * </RevealOnScroll>
 * ```
 */
export const RevealOnScroll: React.FC<RevealOnScrollProps> = ({
  children,
  as = 'div',
  once = true,
  amount = 0.3,
  margin = '0px',
  className,
  ...props
}) => {
  const prefersReducedMotion = useReducedMotion();
  const variants = prefersReducedMotion ? revealFadeVariants : revealVariants;

  // Create the appropriate motion component
  const MotionComponent = motion[as] as typeof motion.div;

  return (
    <MotionComponent
      variants={variants}
      initial="hidden"
      whileInView="visible"
      viewport={{ once, amount, margin }}
      className={className}
      {...props}
    >
      {children}
    </MotionComponent>
  );
};

export default RevealOnScroll;
```
  </action>
  <verify>`npm run ts:check:types` passes</verify>
  <done>RevealOnScroll component exists with reduced-motion handling and configurable viewport</done>
</task>

<task type="auto">
  <name>Task 3: Export reveal variants and component from index.ts</name>
  <files>src/lib/motion/index.ts</files>
  <action>
Update the motion module's public API to export the new reveal variants:

Add to the VARIANTS section exports:
```typescript
export {
  pageVariants,
  fadeVariants,
  staggerContainer,
  staggerItem,
  overlayVariants,
  modalVariants,
  // New reveal variants
  revealVariants,
  revealContainerVariants,
  revealItemVariants,
  revealFadeVariants,
} from './variants';
```

Note: RevealOnScroll component is in src/components, not src/lib/motion, so it doesn't need to be exported from here. Users import it directly from '@/components/RevealOnScroll' or it can be added to a components barrel export later.
  </action>
  <verify>`npm run build` succeeds</verify>
  <done>All reveal variants exported from @/lib/motion</done>
</task>

</tasks>

<verification>
1. `npm run ts:check:types` - No TypeScript errors
2. `npm run build` - Production build succeeds
3. Verify exports: Create test file that imports `revealVariants` from '@/lib/motion'
4. Verify RevealOnScroll compiles correctly
</verification>

<success_criteria>
- Four reveal variant sets in variants.ts with JSDoc docs
- RevealOnScroll component with reduced-motion support
- Variants exported from @/lib/motion
- No TypeScript or build errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-smooth-scroll-integration/05-02-SUMMARY.md`
</output>
